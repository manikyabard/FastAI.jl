<HTML><head><title>How to find a good learning rate</title><link href=../../template/hugobook.css rel=stylesheet ></link><meta content=Type=text/html; charset=utf-8 http-equiv=Content-Type ></meta></head><body><input onclick=toggleMenu() id=menu-control class=hidden toggle type=checkbox ></input><input id=toc-control type=checkbox class=hidden toggle ></input><main class=container flex ><aside id=menu-container class=book-menu ><nav class=book-menu-content ><h2 id=title >FastAI.jl</h2><div id=sidebar ><div class=doctree ><body><ul><li><p><a href=../../README.md.html title= >README</a></p></li><li><p><a href=../setup.md.html title= >Setup</a></p></li><li><p><a href=../quickstart.md.html title= >Quickstart</a></p></li><li><p>Tutorials</p><ul><li><p><a href=../introduction.md.html title= >Introduction</a></p></li><li><p><a href=../data_containers.md.html title= >Data containers</a></p></li><li><p><a href=../learning_methods.md.html title= >Learning methods</a></p></li><li><p><a href=serialization.ipynb.html title= >Saving and loading models</a></p></li><li><p><a href=../tutorials/presizing.ipynb.html title= >Presizing vision datasets</a></p></li></ul></li><li><p>Learning tasks</p><ul><li><p><a href=../methods/imageclassification.md.html title= >Image classification</a></p></li><li><p><a href=imagesegmentation.ipynb.html title= >Image segmentation</a></p></li><li><p><a href=keypointregression.ipynb.html title= >Keypoint regression</a></p></li></ul></li><li><p>How To</p><ul><li><p><a href=fitonecycle.ipynb.html title= >Train a model from scratch</a></p></li><li><p><a href=finetune.ipynb.html title= >Finetune a pretrained model</a></p></li><li><p><a href=lrfind.ipynb.html title= >Find a good learning rate</a></p></li><li><p><a href=../howto/augmentvision.md.html title= >Augment vision data</a></p></li><li><p><a href=how_to_visualize.ipynb.html title= >Visualize data</a></p></li><li><p><a href=../howto/logtensorboard.md.html title= >Log to TensorBoard</a></p></li></ul></li><li><p>Reference</p><ul><li><p><a href=../../REFERENCE.html title= >Docstrings</a></p></li><li><p><a href=../interfaces.md.html title= >Interfaces</a></p></li><li><p><a href=../api.md.html title= >API</a></p></li><li><p><a href=../glossary.md.html title= >Glossary</a></p></li></ul></li><li><p>Background</p><ul><li><p><a href=../background/datapipelines.md.html title= >Performant data pipelines</a></p></li></ul></li></ul></body></div></div></nav></aside><div class=book-page ><header class=book-header ></header><article><h1 id=how-to-find-a-good-learning-rate >How to find a good learning rate</h1><p>Finding a good learning rate is very important when training models. If it’s too large, the training will diverge, and if it’s too low, training will be unnecessarily slow.</p><p>We can use a heuristic called the learning rate finder to find a good learning rate. It works by training with a very low learning rate and exponentially increasing it very quickly until the loss diverges. By plotting learning rates against losses we can find a good a value.</p><p>We’ll set up a <code>Learner</code> as usual:</p><pre lang=julia ><code>using FastAI
data = Datasets.loadtaskdata(Datasets.datasetpath(&quot;imagenette2-160&quot;), ImageClassificationTask)
method = ImageClassification(Datasets.getclassesclassification(&quot;imagenette2-160&quot;), (160, 160))
learner = methodlearner(method, data, Models.xresnet18(), ToGPU(), Metrics(accuracy))</code></pre><p>Then we use the <code>LRFinderPhase</code> which handles the exponential learning rate scheduling and early termination. It will also reset the model when it is done.</p><pre lang=julia ><code>phase = FastAI.LRFinderPhase(steps = 100, β = 0.02)
fit!(learner, phase)</code></pre><pre class=codeoutput ><code>[32mEpoch 1 FastAI.LRFinderPhase(1.0e-7, 10, 100, 0.02, 4, nothing):  14%  ETA: 0:00:38[39m┌──────────────────────┬───────┬────────┬────────────┐
│[1m                Phase [0m│[1m Epoch [0m│[1m   Loss [0m│[1m SmoothLoss [0m│
├──────────────────────┼───────┼────────┼────────────┤
│ FastAI.LRFinderPhase │   1.0 │ 2.8504 │    23.4742 │
└──────────────────────┴───────┴────────┴────────────┘
</code></pre><pre class=coderesult ><code>Learner()</code></pre><p>To visualize the results, you will need to import a plotting backend.</p><pre lang=julia ><code>using CairoMakie</code></pre><pre lang=julia ><code>FastAI.plotlrfind(phase)</code></pre><div class=coderesult ><?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="700pt" height="400pt" viewBox="0 0 700 400" version="1.1">
<defs>
<g>
<symbol overflow="visible" id="glyph0-0">
<path style="stroke:none;" d="M 0.5 1.765625 L 0.5 -7.046875 L 5.5 -7.046875 L 5.5 1.765625 Z M 1.0625 1.21875 L 4.9375 1.21875 L 4.9375 -6.484375 L 1.0625 -6.484375 Z M 1.0625 1.21875 "/>
</symbol>
<symbol overflow="visible" id="glyph0-1">
<path style="stroke:none;" d="M 1.234375 -0.828125 L 2.859375 -0.828125 L 2.859375 -6.390625 L 1.09375 -6.046875 L 1.09375 -6.9375 L 2.84375 -7.296875 L 3.828125 -7.296875 L 3.828125 -0.828125 L 5.4375 -0.828125 L 5.4375 0 L 1.234375 0 Z M 1.234375 -0.828125 "/>
</symbol>
<symbol overflow="visible" id="glyph0-2">
<path style="stroke:none;" d="M 1.0625 -1.234375 L 2.09375 -1.234375 L 2.09375 0 L 1.0625 0 Z M 1.0625 -1.234375 "/>
</symbol>
<symbol overflow="visible" id="glyph0-3">
<path style="stroke:none;" d="M 3.171875 -6.640625 C 2.671875 -6.640625 2.289062 -6.390625 2.03125 -5.890625 C 1.78125 -5.390625 1.65625 -4.640625 1.65625 -3.640625 C 1.65625 -2.640625 1.78125 -1.890625 2.03125 -1.390625 C 2.289062 -0.890625 2.671875 -0.640625 3.171875 -0.640625 C 3.691406 -0.640625 4.078125 -0.890625 4.328125 -1.390625 C 4.585938 -1.890625 4.71875 -2.640625 4.71875 -3.640625 C 4.71875 -4.640625 4.585938 -5.390625 4.328125 -5.890625 C 4.078125 -6.390625 3.691406 -6.640625 3.171875 -6.640625 Z M 3.171875 -7.421875 C 3.992188 -7.421875 4.617188 -7.097656 5.046875 -6.453125 C 5.484375 -5.804688 5.703125 -4.867188 5.703125 -3.640625 C 5.703125 -2.410156 5.484375 -1.472656 5.046875 -0.828125 C 4.617188 -0.179688 3.992188 0.140625 3.171875 0.140625 C 2.359375 0.140625 1.734375 -0.179688 1.296875 -0.828125 C 0.867188 -1.472656 0.65625 -2.410156 0.65625 -3.640625 C 0.65625 -4.867188 0.867188 -5.804688 1.296875 -6.453125 C 1.734375 -7.097656 2.359375 -7.421875 3.171875 -7.421875 Z M 3.171875 -7.421875 "/>
</symbol>
<symbol overflow="visible" id="glyph0-4">
<path style="stroke:none;" d="M 5.625 -2.953125 L 5.625 -2.515625 L 1.484375 -2.515625 C 1.523438 -1.898438 1.710938 -1.429688 2.046875 -1.109375 C 2.378906 -0.785156 2.84375 -0.625 3.4375 -0.625 C 3.78125 -0.625 4.113281 -0.664062 4.4375 -0.75 C 4.769531 -0.832031 5.09375 -0.957031 5.40625 -1.125 L 5.40625 -0.28125 C 5.082031 -0.144531 4.75 -0.0390625 4.40625 0.03125 C 4.070312 0.101562 3.734375 0.140625 3.390625 0.140625 C 2.515625 0.140625 1.820312 -0.109375 1.3125 -0.609375 C 0.800781 -1.117188 0.546875 -1.8125 0.546875 -2.6875 C 0.546875 -3.582031 0.785156 -4.289062 1.265625 -4.8125 C 1.753906 -5.332031 2.410156 -5.59375 3.234375 -5.59375 C 3.972656 -5.59375 4.554688 -5.359375 4.984375 -4.890625 C 5.410156 -4.421875 5.625 -3.773438 5.625 -2.953125 Z M 4.71875 -3.21875 C 4.71875 -3.707031 4.582031 -4.097656 4.3125 -4.390625 C 4.039062 -4.691406 3.6875 -4.84375 3.25 -4.84375 C 2.738281 -4.84375 2.332031 -4.695312 2.03125 -4.40625 C 1.738281 -4.125 1.566406 -3.726562 1.515625 -3.21875 Z M 4.71875 -3.21875 "/>
</symbol>
<symbol overflow="visible" id="glyph0-5">
<path style="stroke:none;" d="M 0.484375 -3.140625 L 3.125 -3.140625 L 3.125 -2.34375 L 0.484375 -2.34375 Z M 0.484375 -3.140625 "/>
</symbol>
<symbol overflow="visible" id="glyph0-6">
<path style="stroke:none;" d="M 0.828125 -7.296875 L 5.515625 -7.296875 L 5.515625 -6.875 L 2.859375 0 L 1.828125 0 L 4.328125 -6.453125 L 0.828125 -6.453125 Z M 0.828125 -7.296875 "/>
</symbol>
<symbol overflow="visible" id="glyph0-7">
<path style="stroke:none;" d="M 3.296875 -4.03125 C 2.859375 -4.03125 2.507812 -3.878906 2.25 -3.578125 C 1.988281 -3.273438 1.859375 -2.863281 1.859375 -2.34375 C 1.859375 -1.8125 1.988281 -1.394531 2.25 -1.09375 C 2.507812 -0.789062 2.859375 -0.640625 3.296875 -0.640625 C 3.742188 -0.640625 4.09375 -0.789062 4.34375 -1.09375 C 4.601562 -1.394531 4.734375 -1.8125 4.734375 -2.34375 C 4.734375 -2.863281 4.601562 -3.273438 4.34375 -3.578125 C 4.09375 -3.878906 3.742188 -4.03125 3.296875 -4.03125 Z M 5.265625 -7.125 L 5.265625 -6.234375 C 5.015625 -6.347656 4.757812 -6.4375 4.5 -6.5 C 4.25 -6.5625 4.003906 -6.59375 3.765625 -6.59375 C 3.109375 -6.59375 2.609375 -6.375 2.265625 -5.9375 C 1.921875 -5.5 1.726562 -4.832031 1.6875 -3.9375 C 1.875 -4.21875 2.113281 -4.429688 2.40625 -4.578125 C 2.695312 -4.734375 3.015625 -4.8125 3.359375 -4.8125 C 4.085938 -4.8125 4.664062 -4.585938 5.09375 -4.140625 C 5.519531 -3.703125 5.734375 -3.101562 5.734375 -2.34375 C 5.734375 -1.59375 5.507812 -0.988281 5.0625 -0.53125 C 4.625 -0.0820312 4.035156 0.140625 3.296875 0.140625 C 2.453125 0.140625 1.804688 -0.179688 1.359375 -0.828125 C 0.921875 -1.472656 0.703125 -2.410156 0.703125 -3.640625 C 0.703125 -4.785156 0.972656 -5.703125 1.515625 -6.390625 C 2.066406 -7.078125 2.800781 -7.421875 3.71875 -7.421875 C 3.96875 -7.421875 4.21875 -7.394531 4.46875 -7.34375 C 4.71875 -7.300781 4.984375 -7.226562 5.265625 -7.125 Z M 5.265625 -7.125 "/>
</symbol>
<symbol overflow="visible" id="glyph0-8">
<path style="stroke:none;" d="M 1.09375 -0.15625 L 1.09375 -1.046875 C 1.34375 -0.929688 1.59375 -0.84375 1.84375 -0.78125 C 2.101562 -0.71875 2.351562 -0.6875 2.59375 -0.6875 C 3.25 -0.6875 3.75 -0.90625 4.09375 -1.34375 C 4.4375 -1.78125 4.628906 -2.445312 4.671875 -3.34375 C 4.484375 -3.0625 4.242188 -2.84375 3.953125 -2.6875 C 3.671875 -2.539062 3.351562 -2.46875 3 -2.46875 C 2.269531 -2.46875 1.691406 -2.6875 1.265625 -3.125 C 0.835938 -3.570312 0.625 -4.175781 0.625 -4.9375 C 0.625 -5.6875 0.84375 -6.285156 1.28125 -6.734375 C 1.726562 -7.191406 2.320312 -7.421875 3.0625 -7.421875 C 3.90625 -7.421875 4.546875 -7.097656 4.984375 -6.453125 C 5.429688 -5.804688 5.65625 -4.867188 5.65625 -3.640625 C 5.65625 -2.492188 5.382812 -1.578125 4.84375 -0.890625 C 4.300781 -0.203125 3.566406 0.140625 2.640625 0.140625 C 2.390625 0.140625 2.140625 0.113281 1.890625 0.0625 C 1.640625 0.0195312 1.375 -0.0507812 1.09375 -0.15625 Z M 3.0625 -3.25 C 3.5 -3.25 3.847656 -3.398438 4.109375 -3.703125 C 4.367188 -4.003906 4.5 -4.414062 4.5 -4.9375 C 4.5 -5.46875 4.367188 -5.882812 4.109375 -6.1875 C 3.847656 -6.488281 3.5 -6.640625 3.0625 -6.640625 C 2.613281 -6.640625 2.257812 -6.488281 2 -6.1875 C 1.75 -5.882812 1.625 -5.46875 1.625 -4.9375 C 1.625 -4.414062 1.75 -4.003906 2 -3.703125 C 2.257812 -3.398438 2.613281 -3.25 3.0625 -3.25 Z M 3.0625 -3.25 "/>
</symbol>
<symbol overflow="visible" id="glyph1-0">
<path style="stroke:none;" d="M 1 3.53125 L 1 -14.109375 L 11 -14.109375 L 11 3.53125 Z M 2.125 2.421875 L 9.890625 2.421875 L 9.890625 -12.984375 L 2.125 -12.984375 Z M 2.125 2.421875 "/>
</symbol>
<symbol overflow="visible" id="glyph1-1">
<path style="stroke:none;" d="M 1.96875 -14.578125 L 3.9375 -14.578125 L 3.9375 -1.65625 L 11.03125 -1.65625 L 11.03125 0 L 1.96875 0 Z M 1.96875 -14.578125 "/>
</symbol>
<symbol overflow="visible" id="glyph1-2">
<path style="stroke:none;" d="M 11.234375 -5.921875 L 11.234375 -5.046875 L 2.984375 -5.046875 C 3.054688 -3.804688 3.425781 -2.859375 4.09375 -2.203125 C 4.757812 -1.554688 5.691406 -1.234375 6.890625 -1.234375 C 7.578125 -1.234375 8.242188 -1.316406 8.890625 -1.484375 C 9.535156 -1.660156 10.179688 -1.914062 10.828125 -2.25 L 10.828125 -0.5625 C 10.179688 -0.28125 9.519531 -0.0703125 8.84375 0.0625 C 8.164062 0.207031 7.476562 0.28125 6.78125 0.28125 C 5.03125 0.28125 3.644531 -0.222656 2.625 -1.234375 C 1.613281 -2.253906 1.109375 -3.628906 1.109375 -5.359375 C 1.109375 -7.148438 1.585938 -8.570312 2.546875 -9.625 C 3.515625 -10.675781 4.820312 -11.203125 6.46875 -11.203125 C 7.9375 -11.203125 9.097656 -10.726562 9.953125 -9.78125 C 10.804688 -8.832031 11.234375 -7.546875 11.234375 -5.921875 Z M 9.4375 -6.453125 C 9.425781 -7.429688 9.148438 -8.210938 8.609375 -8.796875 C 8.078125 -9.378906 7.367188 -9.671875 6.484375 -9.671875 C 5.484375 -9.671875 4.679688 -9.390625 4.078125 -8.828125 C 3.472656 -8.265625 3.125 -7.46875 3.03125 -6.4375 Z M 9.4375 -6.453125 "/>
</symbol>
<symbol overflow="visible" id="glyph1-3">
<path style="stroke:none;" d="M 6.859375 -5.5 C 5.398438 -5.5 4.390625 -5.332031 3.828125 -5 C 3.273438 -4.664062 3 -4.097656 3 -3.296875 C 3 -2.660156 3.207031 -2.15625 3.625 -1.78125 C 4.050781 -1.40625 4.625 -1.21875 5.34375 -1.21875 C 6.34375 -1.21875 7.140625 -1.570312 7.734375 -2.28125 C 8.335938 -2.988281 8.640625 -3.925781 8.640625 -5.09375 L 8.640625 -5.5 Z M 10.4375 -6.234375 L 10.4375 0 L 8.640625 0 L 8.640625 -1.65625 C 8.234375 -1 7.722656 -0.507812 7.109375 -0.1875 C 6.492188 0.125 5.742188 0.28125 4.859375 0.28125 C 3.742188 0.28125 2.851562 -0.03125 2.1875 -0.65625 C 1.53125 -1.289062 1.203125 -2.132812 1.203125 -3.1875 C 1.203125 -4.414062 1.613281 -5.34375 2.4375 -5.96875 C 3.257812 -6.59375 4.488281 -6.90625 6.125 -6.90625 L 8.640625 -6.90625 L 8.640625 -7.078125 C 8.640625 -7.910156 8.367188 -8.550781 7.828125 -9 C 7.285156 -9.445312 6.519531 -9.671875 5.53125 -9.671875 C 4.90625 -9.671875 4.296875 -9.597656 3.703125 -9.453125 C 3.117188 -9.304688 2.550781 -9.082031 2 -8.78125 L 2 -10.4375 C 2.65625 -10.695312 3.289062 -10.890625 3.90625 -11.015625 C 4.53125 -11.140625 5.132812 -11.203125 5.71875 -11.203125 C 7.300781 -11.203125 8.484375 -10.789062 9.265625 -9.96875 C 10.046875 -9.144531 10.4375 -7.898438 10.4375 -6.234375 Z M 10.4375 -6.234375 "/>
</symbol>
<symbol overflow="visible" id="glyph1-4">
<path style="stroke:none;" d="M 8.21875 -9.265625 C 8.019531 -9.378906 7.800781 -9.460938 7.5625 -9.515625 C 7.320312 -9.566406 7.0625 -9.59375 6.78125 -9.59375 C 5.757812 -9.59375 4.976562 -9.265625 4.4375 -8.609375 C 3.894531 -7.953125 3.625 -7.003906 3.625 -5.765625 L 3.625 0 L 1.8125 0 L 1.8125 -10.9375 L 3.625 -10.9375 L 3.625 -9.234375 C 4 -9.898438 4.488281 -10.394531 5.09375 -10.71875 C 5.695312 -11.039062 6.4375 -11.203125 7.3125 -11.203125 C 7.425781 -11.203125 7.554688 -11.191406 7.703125 -11.171875 C 7.859375 -11.160156 8.03125 -11.140625 8.21875 -11.109375 Z M 8.21875 -9.265625 "/>
</symbol>
<symbol overflow="visible" id="glyph1-5">
<path style="stroke:none;" d="M 10.984375 -6.609375 L 10.984375 0 L 9.1875 0 L 9.1875 -6.546875 C 9.1875 -7.578125 8.984375 -8.347656 8.578125 -8.859375 C 8.171875 -9.378906 7.566406 -9.640625 6.765625 -9.640625 C 5.785156 -9.640625 5.015625 -9.328125 4.453125 -8.703125 C 3.898438 -8.085938 3.625 -7.25 3.625 -6.1875 L 3.625 0 L 1.8125 0 L 1.8125 -10.9375 L 3.625 -10.9375 L 3.625 -9.234375 C 4.050781 -9.890625 4.554688 -10.378906 5.140625 -10.703125 C 5.722656 -11.035156 6.394531 -11.203125 7.15625 -11.203125 C 8.414062 -11.203125 9.367188 -10.8125 10.015625 -10.03125 C 10.660156 -9.257812 10.984375 -8.117188 10.984375 -6.609375 Z M 10.984375 -6.609375 "/>
</symbol>
<symbol overflow="visible" id="glyph1-6">
<path style="stroke:none;" d="M 1.890625 -10.9375 L 3.6875 -10.9375 L 3.6875 0 L 1.890625 0 Z M 1.890625 -15.203125 L 3.6875 -15.203125 L 3.6875 -12.921875 L 1.890625 -12.921875 Z M 1.890625 -15.203125 "/>
</symbol>
<symbol overflow="visible" id="glyph1-7">
<path style="stroke:none;" d="M 9.078125 -5.59375 C 9.078125 -6.894531 8.804688 -7.90625 8.265625 -8.625 C 7.734375 -9.34375 6.984375 -9.703125 6.015625 -9.703125 C 5.054688 -9.703125 4.304688 -9.34375 3.765625 -8.625 C 3.222656 -7.90625 2.953125 -6.894531 2.953125 -5.59375 C 2.953125 -4.300781 3.222656 -3.296875 3.765625 -2.578125 C 4.304688 -1.859375 5.054688 -1.5 6.015625 -1.5 C 6.984375 -1.5 7.734375 -1.859375 8.265625 -2.578125 C 8.804688 -3.296875 9.078125 -4.300781 9.078125 -5.59375 Z M 10.875 -1.359375 C 10.875 0.503906 10.460938 1.890625 9.640625 2.796875 C 8.816406 3.703125 7.550781 4.15625 5.84375 4.15625 C 5.207031 4.15625 4.609375 4.109375 4.046875 4.015625 C 3.492188 3.921875 2.953125 3.773438 2.421875 3.578125 L 2.421875 1.84375 C 2.953125 2.125 3.472656 2.332031 3.984375 2.46875 C 4.492188 2.601562 5.019531 2.671875 5.5625 2.671875 C 6.738281 2.671875 7.617188 2.363281 8.203125 1.75 C 8.785156 1.132812 9.078125 0.207031 9.078125 -1.03125 L 9.078125 -1.921875 C 8.710938 -1.273438 8.238281 -0.789062 7.65625 -0.46875 C 7.070312 -0.15625 6.378906 0 5.578125 0 C 4.234375 0 3.148438 -0.507812 2.328125 -1.53125 C 1.515625 -2.550781 1.109375 -3.90625 1.109375 -5.59375 C 1.109375 -7.289062 1.515625 -8.648438 2.328125 -9.671875 C 3.148438 -10.691406 4.234375 -11.203125 5.578125 -11.203125 C 6.378906 -11.203125 7.070312 -11.039062 7.65625 -10.71875 C 8.238281 -10.40625 8.710938 -9.925781 9.078125 -9.28125 L 9.078125 -10.9375 L 10.875 -10.9375 Z M 10.875 -1.359375 "/>
</symbol>
<symbol overflow="visible" id="glyph1-8">
<path style="stroke:none;" d=""/>
</symbol>
<symbol overflow="visible" id="glyph1-9">
<path style="stroke:none;" d="M 3.65625 -14.046875 L 3.65625 -10.9375 L 7.359375 -10.9375 L 7.359375 -9.546875 L 3.65625 -9.546875 L 3.65625 -3.609375 C 3.65625 -2.710938 3.773438 -2.132812 4.015625 -1.875 C 4.265625 -1.625 4.765625 -1.5 5.515625 -1.5 L 7.359375 -1.5 L 7.359375 0 L 5.515625 0 C 4.128906 0 3.171875 -0.253906 2.640625 -0.765625 C 2.117188 -1.285156 1.859375 -2.234375 1.859375 -3.609375 L 1.859375 -9.546875 L 0.53125 -9.546875 L 0.53125 -10.9375 L 1.859375 -10.9375 L 1.859375 -14.046875 Z M 3.65625 -14.046875 "/>
</symbol>
<symbol overflow="visible" id="glyph2-0">
<path style="stroke:none;" d="M 3.53125 -1 L -14.109375 -1 L -14.109375 -11 L 3.53125 -11 Z M 2.421875 -2.125 L 2.421875 -9.890625 L -12.984375 -9.890625 L -12.984375 -2.125 Z M 2.421875 -2.125 "/>
</symbol>
<symbol overflow="visible" id="glyph2-1">
<path style="stroke:none;" d="M -14.578125 -1.96875 L -14.578125 -3.9375 L -1.65625 -3.9375 L -1.65625 -11.03125 L 0 -11.03125 L 0 -1.96875 Z M -14.578125 -1.96875 "/>
</symbol>
<symbol overflow="visible" id="glyph2-2">
<path style="stroke:none;" d="M -9.671875 -6.125 C -9.671875 -5.15625 -9.296875 -4.390625 -8.546875 -3.828125 C -7.796875 -3.273438 -6.765625 -3 -5.453125 -3 C -4.148438 -3 -3.117188 -3.273438 -2.359375 -3.828125 C -1.609375 -4.390625 -1.234375 -5.15625 -1.234375 -6.125 C -1.234375 -7.082031 -1.609375 -7.835938 -2.359375 -8.390625 C -3.117188 -8.953125 -4.148438 -9.234375 -5.453125 -9.234375 C -6.753906 -9.234375 -7.78125 -8.953125 -8.53125 -8.390625 C -9.289062 -7.835938 -9.671875 -7.082031 -9.671875 -6.125 Z M -11.203125 -6.125 C -11.203125 -7.6875 -10.691406 -8.910156 -9.671875 -9.796875 C -8.660156 -10.691406 -7.253906 -11.140625 -5.453125 -11.140625 C -3.671875 -11.140625 -2.269531 -10.691406 -1.25 -9.796875 C -0.226562 -8.910156 0.28125 -7.6875 0.28125 -6.125 C 0.28125 -4.550781 -0.226562 -3.320312 -1.25 -2.4375 C -2.269531 -1.550781 -3.671875 -1.109375 -5.453125 -1.109375 C -7.253906 -1.109375 -8.660156 -1.550781 -9.671875 -2.4375 C -10.691406 -3.320312 -11.203125 -4.550781 -11.203125 -6.125 Z M -11.203125 -6.125 "/>
</symbol>
<symbol overflow="visible" id="glyph2-3">
<path style="stroke:none;" d="M -10.609375 -8.859375 L -8.921875 -8.859375 C -9.179688 -8.347656 -9.375 -7.816406 -9.5 -7.265625 C -9.632812 -6.722656 -9.703125 -6.160156 -9.703125 -5.578125 C -9.703125 -4.679688 -9.5625 -4.007812 -9.28125 -3.5625 C -9.007812 -3.125 -8.601562 -2.90625 -8.0625 -2.90625 C -7.644531 -2.90625 -7.316406 -3.0625 -7.078125 -3.375 C -6.835938 -3.695312 -6.609375 -4.335938 -6.390625 -5.296875 L -6.265625 -5.921875 C -5.984375 -7.191406 -5.59375 -8.09375 -5.09375 -8.625 C -4.601562 -9.164062 -3.910156 -9.4375 -3.015625 -9.4375 C -2.003906 -9.4375 -1.203125 -9.035156 -0.609375 -8.234375 C -0.015625 -7.429688 0.28125 -6.328125 0.28125 -4.921875 C 0.28125 -4.335938 0.222656 -3.726562 0.109375 -3.09375 C -0.00390625 -2.457031 -0.175781 -1.785156 -0.40625 -1.078125 L -2.25 -1.078125 C -1.90625 -1.742188 -1.644531 -2.398438 -1.46875 -3.046875 C -1.300781 -3.691406 -1.21875 -4.332031 -1.21875 -4.96875 C -1.21875 -5.8125 -1.363281 -6.457031 -1.65625 -6.90625 C -1.945312 -7.363281 -2.351562 -7.59375 -2.875 -7.59375 C -3.363281 -7.59375 -3.738281 -7.425781 -4 -7.09375 C -4.257812 -6.769531 -4.507812 -6.050781 -4.75 -4.9375 L -4.90625 -4.3125 C -5.132812 -3.195312 -5.488281 -2.390625 -5.96875 -1.890625 C -6.457031 -1.398438 -7.128906 -1.15625 -7.984375 -1.15625 C -9.003906 -1.15625 -9.796875 -1.519531 -10.359375 -2.25 C -10.921875 -2.976562 -11.203125 -4.015625 -11.203125 -5.359375 C -11.203125 -6.023438 -11.148438 -6.648438 -11.046875 -7.234375 C -10.953125 -7.816406 -10.804688 -8.359375 -10.609375 -8.859375 Z M -10.609375 -8.859375 "/>
</symbol>
</g>
<clipPath id="clip1">
  <path d="M 81 30 L 657 30 L 657 305 L 81 305 Z M 81 30 "/>
</clipPath>
</defs>
<g id="surface116">
<rect x="0" y="0" width="700" height="400" style="fill:rgb(100%,100%,100%);fill-opacity:1;stroke:none;"/>
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(100%,100%,100%);fill-opacity:1;" d="M 68 305 L 670 305 L 670 30 L 68 30 Z M 68 305 "/>
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:0.1;stroke-miterlimit:10;" d="M 89.414062 305 L 89.414062 30 M 163.773438 305 L 163.773438 30 M 238.128906 305 L 238.128906 30 M 312.488281 305 L 312.488281 30 M 386.847656 305 L 386.847656 30 M 461.203125 305 L 461.203125 30 M 535.5625 305 L 535.5625 30 M 609.917969 305 L 609.917969 30 "/>
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 89.414062 305.5 L 89.414062 315.5 M 163.773438 305.5 L 163.773438 315.5 M 238.128906 305.5 L 238.128906 315.5 M 312.488281 305.5 L 312.488281 315.5 M 386.847656 305.5 L 386.847656 315.5 M 461.203125 305.5 L 461.203125 315.5 M 535.5625 305.5 L 535.5625 315.5 M 609.917969 305.5 L 609.917969 315.5 "/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="73.691406" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="80.050781" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="83.230469" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="89.59375" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-5" x="95.746094" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-6" x="99.355469" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="147.875" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="154.238281" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="157.414062" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="163.777344" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-5" x="169.929688" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-7" x="173.539062" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="177.929688" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="184.292969" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="187.472656" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="193.832031" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="200.195312" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="206.558594" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="212.921875" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="219.28125" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="225.644531" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="232.007812" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="238.371094" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="244.730469" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="251.09375" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="257.457031" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="263.820312" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="270.179688" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-8" x="276.542969" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-4" x="282.90625" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-5" x="289.058594" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-7" x="292.667969" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="295.675781" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="302.035156" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="305.214844" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="311.578125" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="317.941406" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="324.300781" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="373.214844" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="379.574219" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="382.753906" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="389.117188" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="395.480469" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="450.75" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="457.113281" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="460.292969" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="466.65625" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="528.289062" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="534.652344" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="537.832031" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-1" x="602.078125" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-2" x="608.441406" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph0-3" x="611.621094" y="330.28125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-1" x="301.847656" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="312.988281" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-3" x="325.292969" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-4" x="337.550781" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-5" x="345.773438" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-6" x="358.449219" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-5" x="364.003906" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-7" x="376.679688" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-8" x="389.375" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-4" x="395.734375" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-3" x="403.957031" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-9" x="416.210938" y="366.203125"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph1-2" x="424.054688" y="366.203125"/>
</g>
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 67.5 305 L 670.5 305 "/>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-1" x="32.28125" y="189.5625"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-2" x="32.28125" y="178.417969"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-3" x="32.28125" y="166.179688"/>
</g>
<g style="fill:rgb(0%,0%,0%);fill-opacity:1;">
  <use xlink:href="#glyph2-3" x="32.28125" y="155.761719"/>
</g>
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 68 305.5 L 68 29.5 "/>
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 67.5 30 L 670.5 30 "/>
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 670 305.5 L 670 29.5 "/>
<g clip-path="url(#clip1)" clip-rule="nonzero">
<path style="fill:none;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;" d="M 95.363281 268.898438 L 101.3125 246.234375 L 107.261719 254.246094 L 113.210938 256.261719 L 119.15625 268.988281 L 125.105469 257.488281 L 131.054688 251.421875 L 137.003906 260.246094 L 142.953125 276.078125 L 148.902344 270.148438 L 154.851562 268.945312 L 160.796875 260.128906 L 166.746094 255.40625 L 172.695312 251.382812 L 178.644531 253.179688 L 184.59375 267.808594 L 190.542969 272.167969 L 196.488281 252.808594 L 202.4375 261.308594 L 208.386719 277.027344 L 214.335938 253.648438 L 220.285156 253.992188 L 226.234375 281.164062 L 232.183594 251.449219 L 238.128906 260.171875 L 244.078125 264.414062 L 250.027344 256.535156 L 255.976562 255.339844 L 261.925781 262.785156 L 267.875 261.628906 L 273.820312 265.703125 L 279.769531 261.125 L 285.71875 260.589844 L 291.667969 271.785156 L 297.617188 264.324219 L 303.566406 261.695312 L 309.515625 277.851562 L 315.460938 257.910156 L 321.410156 265.613281 L 327.359375 261.488281 L 333.308594 274.023438 L 339.257812 270.457031 L 345.207031 270.34375 L 351.152344 262.980469 L 357.101562 267.527344 L 363.050781 271.664062 L 369 272.398438 L 374.949219 262.9375 L 380.898438 282.425781 L 386.847656 270.027344 L 392.792969 276.664062 L 398.742188 292.5 L 404.691406 286.257812 L 410.640625 285.339844 L 416.589844 275.871094 L 422.539062 283.726562 L 428.484375 266.441406 L 434.433594 266.199219 L 440.382812 279.015625 L 446.332031 264.355469 L 452.28125 265.230469 L 458.230469 241.730469 L 464.179688 262.832031 L 470.125 268.53125 L 476.074219 274.207031 L 482.023438 266.238281 L 487.972656 254.886719 L 493.921875 233.457031 L 499.871094 273.511719 L 505.816406 240.835938 L 511.765625 241.28125 L 517.714844 220.953125 L 523.664062 206.792969 L 529.613281 239.289062 L 535.5625 220.480469 L 541.511719 242.71875 L 547.457031 242.378906 L 553.40625 210.460938 L 559.355469 276.9375 L 565.304688 243.714844 L 571.253906 250.453125 L 577.203125 243.320312 L 583.148438 223.648438 L 589.097656 266.273438 L 595.046875 266.984375 L 600.996094 229.800781 L 606.945312 229.769531 L 612.894531 222.039062 L 618.84375 228.578125 L 624.789062 195.257812 L 630.738281 197.789062 L 636.6875 183.574219 L 642.636719 42.5 "/>
</g>
</g>
</svg>
</div><p>A good rule of thumb is to look at where the loss diverges and divide the learning rate at that point by 10. In this case this gives us a learning rate of about <code>0.1</code>. Let’s use that to train our model:</p><pre lang=julia ><code>fitonecycle!(learner, 5, 0.1)</code></pre></article><footer class=book-footer ></footer></div><aside class=book-toc ><nav id=toc class=book-toc-content ><ul><li><a href=#how-to-find-a-good-learning-rate >How to find a good learning rate</a><ul></ul></li></ul></nav></aside></main></body></HTML>